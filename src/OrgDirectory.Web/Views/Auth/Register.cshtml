@model OrgDirectory.Web.Models.RegisterViewModel
@{
    ViewData["Title"] = "Регистрация";
}

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;600&display=swap" rel="stylesheet">


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">


<link rel="stylesheet" href="@Url.Content("~/css/register-glass.css")">


<style>
  :root { --auth-bg: url('@Url.Content("~/img/3a3d46.png")'); }
</style>

<div class="auth-shell">
    <div class="square sq1"></div>
    <div class="square sq2"></div>
    <div class="square sq3"></div>
    <div class="square sq4"></div>

    <div class="auth-card shadow-lg">
        <h2 class="auth-title mb-3">Создать аккаунт</h2>

        <form asp-action="Register" method="post" novalidate class="auth-form">
            @Html.AntiForgeryToken()

            <div class="alert alert-danger auth-summary" asp-validation-summary="ModelOnly"></div>

            <div class="mb-3">
                <label asp-for="Login" class="visually-hidden"></label>
                <input asp-for="Login" class="form-control form-control-lg rounded-pill auth-input" placeholder="Логин" autocomplete="username" />
                <span asp-validation-for="Login" class="invalid-feedback d-block"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Email" class="visually-hidden"></label>
                <input asp-for="Email" class="form-control form-control-lg rounded-pill auth-input" placeholder="E-mail" autocomplete="email" />
                <span asp-validation-for="Email" class="invalid-feedback d-block"></span>
            </div>

            <div class="mb-3 position-relative">
                <label asp-for="Password" class="visually-hidden"></label>
                <input asp-for="Password" class="form-control form-control-lg rounded-pill auth-input pe-5" placeholder="Пароль" autocomplete="new-password" />
                <button type="button" class="btn btn-link px-3 py-0 position-absolute top-50 end-0 translate-middle-y toggle-pass"
                        data-toggle-password="#Password">Показать</button>
                <span asp-validation-for="Password" class="invalid-feedback d-block"></span>
            </div>

            <div class="mb-4 position-relative">
                <label asp-for="ConfirmPassword" class="visually-hidden"></label>
                <input asp-for="ConfirmPassword" class="form-control form-control-lg rounded-pill auth-input pe-5" placeholder="Повторите пароль" autocomplete="new-password" />
                <button type="button" class="btn btn-link px-3 py-0 position-absolute top-50 end-0 translate-middle-y toggle-pass"
                        data-toggle-password="#ConfirmPassword">Показать</button>
                <span asp-validation-for="ConfirmPassword" class="invalid-feedback d-block"></span>
            </div>

            <input type="hidden" name="returnUrl" value="@ViewBag.ReturnUrl" />

            <button type="submit" class="btn btn-light btn-lg rounded-pill w-100 fw-semibold auth-btn" id="submitBtn">
                Зарегистрироваться
                <span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
            </button>

            <div class="auth-links text-center mt-3">
                <span class="text-light">Уже есть аккаунт?</span>
                <a asp-action="Login" asp-route-returnUrl="@ViewBag.ReturnUrl" class="label1 ms-2">Войти</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // показать / скрыть пароль
        document.querySelectorAll('.toggle-pass').forEach(btn => {
            btn.addEventListener('click', function () {
                const input = document.querySelector(this.dataset.togglePassword);
                const isPwd = input.type === 'password';
                input.type = isPwd ? 'text' : 'password';
                this.textContent = isPwd ? 'Скрыть' : 'Показать';
                input.focus();
            });
        });
        // спиннер и блокировка
        const form = document.querySelector('.auth-form');
        const submitBtn = document.getElementById('submitBtn');
        if (form && submitBtn) {
            form.addEventListener('submit', function () {
                submitBtn.disabled = true;
                submitBtn.querySelector('.spinner-border').classList.remove('d-none');
            });
        }
    </script>
}
